package org.comstudy21.ch04.ex04;

import java.util.Scanner;

import org.comstudy21.ch04.ex03.People;

public class Ch04Ex06 {
	public static final int MAX = 100;
	private People[] pArr = new People[MAX];
	private int top = 0;
	private int seq = 0; // 감소없이 계속 증가 idx에 사용
	private int thatnum = 0;
	public static final Scanner sc = new Scanner(System.in);

	public Ch04Ex06() {
		while (true) {
			run();
		}

	}

	public void run() {

		switch (menu()) {
		case 1:
			input();
			break;
		case 2:
			output();
			break;
		case 3:
			search();
			break;
		case 4:
			modify();
			break;
		case 5:
			delete();
			break;
		case 6:
			System.out.println("주소록을 종료합니다.");
			System.exit(0);
			break;
		default:
			System.out.println("해당사항없음");
		}
		System.out.println("☎☏☎☏☎☏☎☏☎☏☎☏☎☏☎☏");

	}

	public int menu() {
		int no = 0;
		System.out.println("1.입력 2.출력 3.검색 4.수정 5.삭제 6.종료");
		System.out.print("선택 >> ");
		no = sc.nextInt();
		sc.nextLine();
		return no;

	}

	public void input() {

		if (top >= pArr.length) {
			System.out.println("주소록이 가득 찼습니다.입력불가");
			return;
		}

		People p = new People();
		p.setIdx(seq++);
		// sc.nextLine();
		System.out.println("이름 : ");
		p.setName(sc.nextLine());
		System.out.println("번호 : ");
		p.setPhone(sc.nextLine());
		System.out.print("입력완료");

		pArr[top++] = p;

		// 객체생성
		// 데이터넣기
		// 객체배열에 [top]번지 담기

	}

	public void output() {

		System.out.println("주소록을 모두 출력합니다.");
		for (People p : pArr) {
			if (p == null)
				break;
			System.out.println(p);
		}

	}

	public void search2() {

		
		
		
		if (seq == 0) {
			System.out.println("주소록이 비어있습니다");
			main(null);

		} else {

			System.out.print("검색할 이름을 입력하세요: ");
			String name = sc.nextLine();

			int j = -1;
			
			
			for (int i = 0; i < seq; i++) {
				if (pArr[i].getName().equals(name)) {
					thatnum = i;
					j = i;
					System.out.println(pArr[thatnum]);
				}
			}
			
			
			if (j == -1) {
				System.out.println("찾을수 없습니다. 다시검색해주세요");
				search();
				return;}

		}
		

	}

	public void search(){
		
		System.out.println("검색할 이름을 입력하세요.");
		String findname = sc.nextLine();
		boolean here = false;
		int you =-1;
		for(int i = 0 ; i < top ; i++){
			People search = pArr[i]; 
			if(search.getName().equals(findname)){
			 you = i;
			 
			 here = true;
			}
		}
		
		if(here)
		{System.out.println(pArr[you]);you =-1;}
		else{System.out.println("존재하지 않는 이름입니다.");main(null);}		
		
		
	}
		
		
		
		
		
	
	
	public void modify() {
	
		System.out.println("검색할 이름을 입력하세요.");
		String findname = sc.nextLine();
		boolean here = false;
		int you =-1;
		for(int i = 0 ; i < top ; i++){
			People search = pArr[i]; 
			if(search.getName().equals(findname)){
			 you = i;
			 
			 here = true;
			}
		}
		
		if(here)
		{System.out.println(pArr[you]);you =-1;}
		else{System.out.println("존재하지 않는 이름입니다.");main(null);}		
		
		
	
		System.out.print("수정할 부분을 입력하세요: \n 1.이름 2.번호 ");
		int select = sc.nextInt();
		sc.nextLine();

		switch (select) {
		case 1:
			System.out.print("변경할 이름을 입력하세요");
			String newname = sc.nextLine();
			pArr[you].setName(newname);

			break;
		case 2:
			System.out.print("변경할 번호을 입력하세요");
			String newphone = sc.nextLine();
			pArr[you].setPhone(newphone);

			break;
		default:
			System.out.println("잘못입력하셨습니다.");
			modify();

		}

	}
	// 수정이나 삭제는 검색을 먼저 거친다음에

	public void delete() {
		System.out.println("검색할 이름을 입력하세요.");
		String findname = sc.nextLine();
		boolean here = false;
		int you =-1;
		for(int i = 0 ; i < top ; i++){
			People search = pArr[i]; 
			if(search.getName().equals(findname)){
			 you = i;
			 here = true;
			}
		}
		
		if(here)
		{System.out.println(pArr[you]);}
		else{System.out.println("존재하지 않는 이름입니다.");main(null);}		

		System.out.println("이 주소록을 삭제할까요? y/n");

		String answer = sc.nextLine();
		switch (answer) {
		case "y":
		case "Y":
			for (int i = you; i < top; i++) {
				pArr[i] = pArr[i + 1];
				
			}top--;
			System.out.println("삭제완료");
			break;
		case "n":
		case "N":
			System.out.println("삭제를 취소합니다");
			break;
		default:
			System.out.println("잘못된입력입니다.다시 검색해주세요");
			delete();
		}
	}

	public static void main(String[] args) {

		new Ch04Ex06();

	}

}
